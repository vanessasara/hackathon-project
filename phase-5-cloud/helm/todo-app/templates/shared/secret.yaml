apiVersion: v1
kind: Secret
metadata:
  name: {{ include "todo-app.fullname" . }}-secrets
  labels:
    {{- include "todo-app.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Database Connection
  DATABASE_URL: {{ required "secrets.DATABASE_URL is required. Pass via --set secrets.DATABASE_URL=..." .Values.secrets.DATABASE_URL | quote }}

  # Authentication
  BETTER_AUTH_SECRET: {{ required "secrets.BETTER_AUTH_SECRET is required. Pass via --set secrets.BETTER_AUTH_SECRET=..." .Values.secrets.BETTER_AUTH_SECRET | quote }}

  # OpenAI API
  OPENAI_API_KEY: {{ required "secrets.OPENAI_API_KEY is required. Pass via --set secrets.OPENAI_API_KEY=..." .Values.secrets.OPENAI_API_KEY | quote }}

  # Cloudflare R2 Storage (optional)
  {{- if .Values.secrets.CLOUDFLARE_R2_ACCOUNT_ID }}
  CLOUDFLARE_R2_ACCOUNT_ID: {{ .Values.secrets.CLOUDFLARE_R2_ACCOUNT_ID | quote }}
  {{- end }}
  {{- if .Values.secrets.CLOUDFLARE_R2_ACCESS_KEY_ID }}
  CLOUDFLARE_R2_ACCESS_KEY_ID: {{ .Values.secrets.CLOUDFLARE_R2_ACCESS_KEY_ID | quote }}
  {{- end }}
  {{- if .Values.secrets.CLOUDFLARE_R2_SECRET_ACCESS_KEY }}
  CLOUDFLARE_R2_SECRET_ACCESS_KEY: {{ .Values.secrets.CLOUDFLARE_R2_SECRET_ACCESS_KEY | quote }}
  {{- end }}
  {{- if .Values.secrets.CLOUDFLARE_R2_BUCKET_NAME }}
  CLOUDFLARE_R2_BUCKET_NAME: {{ .Values.secrets.CLOUDFLARE_R2_BUCKET_NAME | quote }}
  {{- end }}

  # Part B: Advanced Features - VAPID keys for Web Push (optional)
  {{- if .Values.secrets.VAPID_PUBLIC_KEY }}
  VAPID_PUBLIC_KEY: {{ .Values.secrets.VAPID_PUBLIC_KEY | quote }}
  {{- end }}
  {{- if .Values.secrets.VAPID_PRIVATE_KEY }}
  VAPID_PRIVATE_KEY: {{ .Values.secrets.VAPID_PRIVATE_KEY | quote }}
  {{- end }}
